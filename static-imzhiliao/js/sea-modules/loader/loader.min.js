define(function(c,b,d){var a={};var f=function(g){this._source=[];this.fails=[];this._index=0;this.failed=0;this.loaded=0;this.percent="0%";this._init(g);this.total=this._source.length;this._load()};f.prototype={_rsuffix:/\.(js|css|mp3)$/,_init:function(g){if(typeof g==="string"){this._source.push(g)}else{if(Array.isArray(g)){this._source=g}else{throw"Loader Error: arguments must be String|Array."}}},_get_load_method:function(h){var g=(g=h.match(this._rsuffix))?g[1]:"img";return"_"+g},_js:function(i,j){var h=this;var g=document.createElement("script");g.onload=function(){j&&j.call(h,true,i)};g.onerror=function(){j&&j.call(h,false,i)};g.type="text/javascript";g.src=i;document.head.appendChild(g)},_css:function(h,i){var g=this;var j=document.createElement("link");j.type="text/css";j.rel="stylesheet";j.href=h;document.head.appendChild(j);i&&i.call(g,true,h)},_img:function(i,j){var h=this;var g=new Image();g.onload=function(){a[i]=g;j&&j.call(h,true,i)};g.onerror=function(){j&&j.call(h,false,i)};g.src=i},_mp3:function(g,h){},_load:function(){if(this._index==this._source.length){return this._onend()}var g=this._source[this._index];if(!g){return}var h=this._get_load_method(g);this[h](g,this._loadend);this._onloadstart(g)},_loadend:function(g,h){if(g){++this.loaded}else{++this.failed;this.fails.push(h)}++this._index;this.percent=Math.ceil(this._index/this.total*100)+"%";this._onloadend(g,h);this._load()},_onloadstart:function(){},_onloadend:function(){},_onend:function(){},loadstart:function(g){if(typeof g==="function"){this._onloadstart=g}return this},loadend:function(g){if(typeof g==="function"){this._onloadend=g}return this},complete:function(g){if(typeof g==="function"){this._onend=g}return this},image:function(h,i){if(arguments.length==1){if(undefined==h){return a}var g=a[h];if(g){return g}g=new Image();g.src=h;return g}if(arguments.length==2){a[h]=i}}};var e=function(g,i,j){var h=document.createElement("style");document.getElementsByTagName("head")[0].appendChild(h);var p=document,l=arguments,i=typeof i=="string"?i:"#E44B46";var k=p.getElementById("MP_loading"),o=p.getElementById("MP_precent");if(!k){k=p.createElement("div");k.className="mp_loading";k.innerHTML='<div class="mp_loading_clip loading"><div class="mp_loading_bar" style="border-color:"'+i+"></div></div>";o=p.createElement("div");o.className="mp_loading_txt";k.calssName="mp_loading";o.innerHTML="0%";k.appendChild(o);document.body.appendChild(k)}this._loadDom=k;this._txtDom=o;var m=this;var n=j;n=typeof n=="function"?n:function(){};new f(g).loadstart(function(){}).loadend(function(q){m._txtDom.innerHTML=this.percent}).complete(function(){m._loadDom.style.display="none";n.apply(m)})};b.loader=f;b.loadermsk=e});